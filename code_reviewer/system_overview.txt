╔══════════════════════════════════════════════════════════════════════════════════╗
║                    🤖 MULTI-AGENT CODE REVIEW SYSTEM ARCHITECTURE                    ║
╚══════════════════════════════════════════════════════════════════════════════════╝

┌─────────────────────┐    ┌─────────────────────┐    ┌─────────────────────┐
│   📄 Code File      │    │   💻 Code String    │    │   📋 Git Diff      │
│   test.js           │    │   "function..."     │    │   +added lines     │
└──────────┬──────────┘    └──────────┬──────────┘    └──────────┬──────────┘
           │                          │                          │
           └──────────────────────────┼──────────────────────────┘
                                      │
                                      ▼
                        ┌─────────────────────────────┐
                        │    🎯 Multi-Agent           │
                        │       Orchestrator          │
                        │  ┌─────────────────────────┐ │
                        │  │ • Parse CLI args        │ │
                        │  │ • Load configuration    │ │
                        │  │ • Initialize agents     │ │
                        │  │ • Coordinate execution  │ │
                        │  └─────────────────────────┘ │
                        └─────────────┬───────────────┘
                                      │
                    ┌─────────────────┼─────────────────┐
                    │                 │                 │
                    ▼                 ▼                 ▼
        ┌─────────────────┐ ┌─────────────────┐ ┌─────────────────┐
        │  🔧 Config      │ │  🔑 LLM         │ │  ⚙️ CLI Args    │
        │  Manager        │ │  Manager        │ │  Parser         │
        │ ┌─────────────┐ │ │ ┌─────────────┐ │ │ ┌─────────────┐ │
        │ │ .env files  │ │ │ │ Singleton   │ │ │ │ --agents    │ │
        │ │ Azure creds │ │ │ │ Azure/Ollama│ │ │ │ --file      │ │
        │ └─────────────┘ │ │ └─────────────┘ │ │ │ --parallel  │ │
        └─────────────────┘ └─────────┬───────┘ │ └─────────────┘ │
                                      │         └─────────────────┘
                                      │
                              ┌───────┼───────┐
                              │               │
                              ▼               ▼
                    ┌─────────────────┐ ┌─────────────────┐
                    │  ☁️ Azure       │ │  🏠 Local       │
                    │  OpenAI         │ │  Ollama         │
                    │ ┌─────────────┐ │ │ ┌─────────────┐ │
                    │ │ OAuth2      │ │ │ │ llama3.2    │ │
                    │ │ GPT Models  │ │ │ │ localhost   │ │
                    │ └─────────────┘ │ │ └─────────────┘ │
                    └─────────────────┘ └─────────────────┘
                              ▲               ▲
                              │               │
                              └───────┬───────┘
                                      │ AI Requests
                                      │
╔═══════════════════════════════════════════════════════════════════════════════════╗
║                           🔍 SPECIALIZED AGENTS (Parallel)                        ║
╠═══════════════════════════════════════════════════════════════════════════════════╣
║                                                                                   ║
║  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ║
║  │🔐 Security  │ │⚡Performance│ │📋 Coding    │ │🏗️Architecture│ │📖Readability│ ║
║  │   Agent     │ │   Agent     │ │ Practices   │ │   Agent     │ │   Agent     │ ║
║  │ ┌─────────┐ │ │ ┌─────────┐ │ │   Agent     │ │ ┌─────────┐ │ │ ┌─────────┐ │ ║
║  │ │SQL Inj. │ │ │ │Loops    │ │ │ ┌─────────┐ │ │ │Coupling │ │ │ │Naming   │ │ ║
║  │ │XSS      │ │ │ │Memory   │ │ │ │SOLID    │ │ │ │Modules  │ │ │ │Comments │ │ ║
║  │ │Auth     │ │ │ │Algorithms│ │ │ │Patterns │ │ │ │Design   │ │ │ │Format   │ │ ║
║  │ └─────────┘ │ │ └─────────┘ │ │ └─────────┘ │ │ └─────────┘ │ │ └─────────┘ │ ║
║  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘ ║
║                                                                                   ║
║                              ┌─────────────┐                                     ║
║                              │🧪Testability│                                     ║
║                              │   Agent     │                                     ║
║                              │ ┌─────────┐ │                                     ║
║                              │ │Coverage │ │                                     ║
║                              │ │Mocking  │ │                                     ║
║                              │ │DI       │ │                                     ║
║                              │ └─────────┘ │                                     ║
║                              └─────────────┘                                     ║
╚═══════════════════════════════════════════════════════════════════════════════════╝
                                      │
                                      ▼
                        ┌─────────────────────────────┐
                        │    🤖 Consolidation         │
                        │       Agent                 │
                        │  ┌─────────────────────────┐ │
                        │  │ • Aggregate findings    │ │
                        │  │ • Prioritize issues     │ │
                        │  │ • Generate summary      │ │
                        │  │ • AI-powered synthesis  │ │
                        │  └─────────────────────────┘ │
                        └─────────────┬───────────────┘
                                      │
                                      ▼
                        ┌─────────────────────────────┐
                        │    📊 JSON Report           │
                        │  ┌─────────────────────────┐ │
                        │  │ {                       │ │
                        │  │   "overall_score": 10,  │ │
                        │  │   "agent_reviews": [...] │ │
                        │  │   "critical_issues": [..] │ │
                        │  │ }                       │ │
                        │  └─────────────────────────┘ │
                        └─────────────┬───────────────┘
                                      │
                                      ▼
                        ┌─────────────────────────────┐
                        │    🎨 PR Review             │
                        │       Formatter             │
                        │  ┌─────────────────────────┐ │
                        │  │ • Map issues to lines   │ │
                        │  │ • Group by severity     │ │
                        │  │ • Generate code context │ │
                        │  │ • Create recommendations│ │
                        │  └─────────────────────────┘ │
                        └─────────────┬───────────────┘
                                      │
                                      ▼
╔══════════════════════════════════════════════════════════════════════════════════╗
║                        📋 GITHUB/GITLAB PR COMMENTS                              ║
╠══════════════════════════════════════════════════════════════════════════════════╣
║                                                                                  ║
║  # 🤖 Multi-Agent Code Review                                                    ║
║                                                                                  ║
║  **File:** `test.js`                                                             ║
║  **Overall Score:** 10/10                                                       ║
║                                                                                  ║
║  ## 🚨 Critical Issues                                                           ║
║                                                                                  ║
║  ### 1. 🔐 **SQL Injection Vulnerability** (Line 7)                             ║
║  **Agent:** SecurityAgent                                                       ║
║                                                                                  ║
║  **Code:**                                                                       ║
║  ```javascript                                                                   ║
║     5: var activeUsers = [];                                                     ║
║     6:                                                                           ║
║  ➤  7: function getUserData(userId) {                                           ║
║     8:     // Potential security issue - no input validation                    ║
║     9:     var query = "SELECT * FROM users WHERE id = '" + userId + "'";      ║
║  ```                                                                             ║
║                                                                                  ║
║  **Issue:** SQL Injection vulnerability in getUserData function                 ║
║                                                                                  ║
║  **Recommended Fix:**                                                            ║
║  ```javascript                                                                   ║
║  // Use parameterized queries:                                                  ║
║  var query = "SELECT * FROM users WHERE id = ?";                               ║
║  var result = database.execute(query, [userId]);                               ║
║  ```                                                                             ║
║                                                                                  ║
║  ## 📊 Review Summary                                                            ║
║  - **Total Issues Found:** 5                                                    ║
║  - **Critical:** 1                                                              ║
║  - **High Priority:** 2                                                         ║
║  - **Medium Priority:** 1                                                       ║
║  - **Low Priority:** 1                                                          ║
║                                                                                  ║
║  ⚠️ **Action Required:** Please address critical and high priority issues       ║
║     before merging.                                                              ║
╚══════════════════════════════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────────────────────────────────────┐
│                               🎯 KEY FEATURES                                   │
├─────────────────────────────────────────────────────────────────────────────────┤
│ • 🔄 Parallel Processing: All 6 agents run simultaneously                      │
│ • 🤖 AI-Powered Analysis: Advanced language models for intelligent insights    │
│ • 📍 Line-Specific Comments: Issues mapped to exact code locations             │
│ • ⚖️ Severity-Based Prioritization: Critical issues highlighted first          │
│ • 🎨 PR-Ready Output: Direct integration with GitHub/GitLab workflows          │
│ • 🔧 Configurable Backend: Azure OpenAI or Local Ollama support               │
│ • 📋 Professional Format: Clean, actionable review comments                    │
└─────────────────────────────────────────────────────────────────────────────────┘
